/*! user
*
* build at 2025-10-10
*/
import*as e from"/public/libs/webmodule/pagehelper.mjs";const t=new $fgta5.Application("mainapp");var o={moduleName:"user",app:t,urlDir:"public/modules/user",Crsl:new $fgta5.SectionCarousell(t.Nodes.Main),Sections:{userHeaderList:"userHeaderList-section",userHeaderEdit:"userHeaderEdit-section",userLoginList:"userLoginList-section",userLoginEdit:"userLoginEdit-section",userPropList:"userPropList-section",userPropEdit:"userPropEdit-section",userGroupList:"userGroupList-section",userGroupEdit:"userGroupEdit-section",userFavouriteList:"userFavouriteList-section",userFavouriteEdit:"userFavouriteEdit-section"},SectionMap:{"userHeaderList-section":"userHeaderList","userHeaderEdit-section":"userHeaderEdit","userLoginList-section":"userLoginList","userLoginEdit-section":"userLoginEdit","userPropList-section":"userPropList","userPropEdit-section":"userPropEdit","userGroupList-section":"userGroupList","userGroupEdit-section":"userGroupEdit","userFavouriteList-section":"userFavouriteList","userFavouriteEdit-section":"userFavouriteEdit"}};const n="userHeaderEdit-obj_user_name";async function a(e,t){const o=e.Modules.userHeaderEdit.getHeaderForm();o.addEventListener("locked",e=>{document.getElementById("btn_resetpassword").classList.add("hidden")}),o.addEventListener("unlocked",e=>{document.getElementById("btn_resetpassword").classList.remove("hidden")});const n=o.Inputs["userHeaderEdit-obj_user_password"];{const e=document.body,t=document.querySelector('template[name="dialog-change-password"]');if(null!=t){const o=t.content.cloneNode(!0);e.prepend(o)}}setTimeout(()=>{const e=document.getElementById("myDialog"),t=document.getElementById("btnChangePassword"),o=document.getElementById("btnCancel"),a=document.getElementById("newPassword"),i=document.getElementById("userHeaderEdit-obj_user_password-container"),r=document.createElement("a");r.setAttribute("id","btn_resetpassword"),r.setAttribute("href","javascript:void(0)"),r.innerHTML="reset password",r.classList.add("hidden"),r.addEventListener("click",t=>{a.value="",e.showModal()}),t.addEventListener("click",t=>{const o=a.value.trim();""!=o?(!async function(e,t,o){try{const e={password:o},n=await Module.apiCall("/profile/encrypt-password",e);t.value=n}catch(e){$fgta5.MessageBox.error(e.message)}}(0,n,o),e.close()):$fgta5.MessageBox.warning("password tidak boleh kosong")}),o.addEventListener("click",t=>{e.close()}),i.appendChild(r)},1e3)}var i=Object.freeze({__proto__:null,init:a,userHeaderEdit_dataSaved:async function(e,t,o){o.Inputs[n].disabled=!0},userHeaderEdit_formOpened:function(e,t,o){t.Inputs[n].disabled=!0},userHeaderEdit_newData:async function(e,t,o){o.Inputs[n].disabled=!1}});const r=o.Crsl,s=o.Sections.userHeaderList,c=r.Items[s],d={},l=new $fgta5.Gridview("userHeaderList-tbl"),u=document.getElementById("userHeaderList-pnl_search"),f=new $fgta5.ActionButton("userHeaderList-btn_gridload"),g=c,p={};async function w(e,t){l.addEventListener("nextdata",async t=>{!async function(e,t){const o=t.detail.criteria,n=t.detail.limit,a=t.detail.nextoffset,i=t.detail.sort;await v(e,{criteria:o,limit:n,offset:a,sort:i}),l.scrollToFooter()}(e,t)}),l.addEventListener("sorting",async t=>{!function(e,t){l.clear();const o=t.detail.sort,n=t.detail.Criteria;v(e,{criteria:n,sort:o})}(e,t)});const o=i.headerList_addTableEvents;"function"==typeof o&&o(e,l),Module.isMobileDevice()?l.addEventListener("cellclick",async t=>{L(e,t)}):l.addEventListener("celldblclick",async t=>{L(e,t)}),f.addEventListener("click",async t=>{!function(e){b(e,null),y(e)}(e)});try{const t=document.querySelector('template[name="custom-search-panel"]');if(null!=t){const e=t.content.cloneNode(!0);u.prepend(e)}const o=u.querySelectorAll("[fgta5-component][binding]");for(var n of o){var a=n.getAttribute("id"),r=n.getAttribute("fgta5-component"),s=n.getAttribute("binding");p[s]=new $fgta5[r](a)}const c=document.getElementById("userHeaderList-txt_searchtext"),d=document.getElementById("userHeaderList-btn_gridload");c.addEventListener("keydown",e=>{"enter"==e.key.toLowerCase()&&(e.stopPropagation(),d.click(),c.blur())});const l=i["headerList_initSearchParams"];"function"==typeof l&&l(e,p)}catch(e){throw e}finally{!0===t.autoLoadGridData&&y(e)}}async function y(e){await l.clear(),v(e)}function m(e,t){const o=d.SelectedRow;o.previousElementSibling?t.disablePrevButton(e,!1):t.disablePrevButton(e,!0),o.nextElementSibling?t.disableNextButton(e,!1):t.disableNextButton(e,!0)}function b(e,t){d.SelectedRow=t}async function E(e,t){const o=t.getAttribute("keyvalue"),n=t.getAttribute("key"),a=e.Modules.userHeaderEdit;a.clearForm(e,"loading...");try{b(0,t),d.SelectedRow.keyValue=o,d.SelectedRow.key=n,await a.openSelectedData(e,{key:n,keyvalue:o})}catch(e){console.error(e),await $fgta5.MessageBox.error(e.message),b(0,null),c.show()}m(e,a)}function L(e,t){const o=t.detail.tr;e.Modules.userHeaderEdit.Section.show({},t=>{E(e,o)})}async function v(e,t={}){const{criteria:n={},limit:a=0,offset:i=0,sort:r={}}=t;for(var s in p){if(!p[s].validate())return console.error("ada yang belum diisi"),!1;n[s]=p[s].value}void 0===r&&(r=l.getSort());let c=$fgta5.Modal.createMask();try{const e=await async function(e,t,n,a,i){const r=`/${o.moduleName}/header-list`;try{const e=[];return await Module.apiCall(r,{columns:e,criteria:t,offset:n,limit:a,sort:i})}catch(e){throw e}}(0,n,i,a,r);0===i&&l.clear(),l.addRows(e.data),l.setNext(e.nextoffset,e.limit)}catch(e){console.error(e),$fgta5.MessageBox.error(e.message)}finally{c.close(),c=null}}var h=Object.freeze({__proto__:null,SearchParams:p,Section:g,addNewRow:function(e,t){b(e,l.addRow(t))},getCurrentRow:function(e){return d.SelectedRow},getGrid:function(e){return l},init:w,keyboardAction:function(e,t,o){if("up"==t)l.previousRecord();else if("down"==t)l.nextRecord();else if("enter"==t){e.Modules.userHeaderEdit.Section.show({},()=>{E(e,l.CurrentRow)})}else if("typing"==t){o.preventDefault(),o.stopPropagation();const e=document.getElementById("userHeaderList-txt_searchtext"),t=o.key;e.focus(),"Backspace"==t?Module.deleteAtCursor(e,"backspace"):"Delete"==t?Module.deleteAtCursor(e,"delete"):Module.insertAtCursor(e,o.key)}},loadData:y,removeCurrentRow:function(e){const t=d.SelectedRow;l.removeRow(t)},selectNextRow:function(e){const t=d.SelectedRow;t.nextElementSibling&&(l.CurrentRow=t.nextElementSibling,E(e,t.nextElementSibling))},selectPreviousRow:function(e){const t=d.SelectedRow;t.previousElementSibling&&(l.CurrentRow=t.previousElementSibling,E(e,t.previousElementSibling))},setPagingButton:m,updateCurrentRow:function(e,t){const o=d.SelectedRow;try{l.updateRow(o,t)}catch(e){throw e}}});const k={},M=o.Crsl,_=o.Sections.userHeaderEdit,I=M.Items[_],S=o.Source,B="New User",C="View User",R="Edit User",$="Edit",x="Lock",N=new $fgta5.ActionButton("userHeaderEdit-btn_edit"),F=new $fgta5.ActionButton("userHeaderEdit-btn_save"),A=new $fgta5.ActionButton("userHeaderEdit-btn_new","userHeader-new"),D=new $fgta5.ActionButton("userHeaderEdit-btn_delete"),P=new $fgta5.ActionButton("userHeaderEdit-btn_reset"),T=new $fgta5.ActionButton("userHeaderEdit-btn_prev"),H=new $fgta5.ActionButton("userHeaderEdit-btn_next"),G=document.getElementById("userHeader-btn_recordstatus"),O=document.getElementById("userHeader-btn_logs"),U=document.getElementById("userHeader-btn_about"),j=new $fgta5.Form("userHeaderEdit-frm");j.Inputs["userHeaderEdit-obj_user_id"],j.Inputs["userHeaderEdit-obj_user_name"],j.Inputs["userHeaderEdit-obj_user_isdisabled"],j.Inputs["userHeaderEdit-obj_user_isdev"],j.Inputs["userHeaderEdit-obj_user_nickname"],j.Inputs["userHeaderEdit-obj_user_fullname"],j.Inputs["userHeaderEdit-obj_user_email"],j.Inputs["userHeaderEdit-obj_user_password"];const K=document.getElementById("fRecord-section-createby"),V=document.getElementById("fRecord-section-createdate"),z=document.getElementById("fRecord-section-modifyby"),q=document.getElementById("fRecord-section-modifydate"),W=I;async function Z(t,n){I.addEventListener($fgta5.Section.EVT_BACKBUTTONCLICK,async e=>{X()}),j.addEventListener("locked",e=>{!async function(e){I.Title=C,N.setText($),N.disabled=!1,F.disabled=!0,A.disabled=!1,D.disabled=!0,P.disabled=!0,T.disabled=!1,H.disabled=!1;const t=i.userHeaderEdit_formLocked;"function"==typeof t&&t(e,j,k);k.editDisabled&&(N.disabled=!0);e.Modules.userLoginList.headerLocked(e),e.Modules.userLoginEdit.headerLocked(e),e.Modules.userPropList.headerLocked(e),e.Modules.userPropEdit.headerLocked(e),e.Modules.userGroupList.headerLocked(e),e.Modules.userGroupEdit.headerLocked(e),e.Modules.userFavouriteList.headerLocked(e),e.Modules.userFavouriteEdit.headerLocked(e)}(t)}),j.addEventListener("unlocked",e=>{!async function(e){j.isNew()?I.Title=B:I.Title=R;N.setText(x),N.disabled=!1,F.disabled=!1,A.disabled=!0,D.disabled=!1,P.disabled=!1,T.disabled=!0,H.disabled=!0;const t=i.userHeaderEdit_formUnlocked;"function"==typeof t&&t(e,j);e.Modules.userLoginList.headerUnlocked(e),e.Modules.userLoginEdit.headerUnlocked(e),e.Modules.userPropList.headerUnlocked(e),e.Modules.userPropEdit.headerUnlocked(e),e.Modules.userGroupList.headerUnlocked(e),e.Modules.userGroupEdit.headerUnlocked(e),e.Modules.userFavouriteList.headerUnlocked(e),e.Modules.userFavouriteEdit.headerUnlocked(e)}(t)}),j.render(),N.addEventListener("click",e=>{!async function(){if(j.isLocked())j.lock(!1);else{if(j.isChanged()||j.isNew())return void await $fgta5.MessageBox.warning(Module.EDIT_WARNING);j.lock(!0)}}()}),F.addEventListener("click",e=>{!async function(e){const t=i.userHeaderEdit_autofill;"function"==typeof t&&await t(e,j);if(!j.validate()){const e=j.getLastError();return void $fgta5.MessageBox.warning(e)}let n;const a=j.isNew();if(a)n=j.getData();else{if(!j.isChanged())return;n=j.getDataChanged()}const r=i.userHeaderEdit_dataSaving;"function"==typeof r&&await r(e,n,j);let s=null;const c=j.getFiles();if(null!=c){s=new FormData;for(let e in c){const t=c[e];s.append(e,t)}}let d=$fgta5.Modal.createMask();try{let t;t=a?await async function(e,t,n){const a=`/${o.moduleName}/header-create`;try{return await Module.apiCall(a,{data:t,source:S},n)}catch(e){throw e}}(0,n,s):await async function(e,t,n){const a=`/${o.moduleName}/header-update`;try{return await Module.apiCall(a,{data:t,source:S},n)}catch(e){throw e}}(0,n,s);const r=j.getPrimaryInput(),c=t[r.getBindingData()],d=await Q(e,c);k.currentOpenedId=c,j.AutoID?r.value=c:Y(e,{disabled:!0}),j.setData(d);const l=i["userHeaderEdit_dataSaved"];"function"==typeof l&&await l(e,d,j),j.acceptChanges(),a?(N.disabled=!1,e.Modules.userHeaderList.addNewRow(e,d)):e.Modules.userHeaderList.updateCurrentRow(e,d)}catch(e){console.error(e),await $fgta5.MessageBox.error(e.message)}finally{d.close(),d=null}}(t)}),A.addEventListener("click",e=>{!async function(e,t){const o=t.target.getAttribute("data-sectionsource"),n=e.Modules.userHeaderList,a=n.Section.Id,r=o===a;if(r)await I.show();else{let e=!1;if(j.isChanged()){"cancel"==await $fgta5.MessageBox.confirm(Module.NEWDATA_CONFIRM)&&(e=!0)}if(e)return}j.AutoID?Y(e,{disabled:!0,placeholder:"[AutoID]"}):Y(e,{disabled:!1,placeholder:"ID"});try{let t={};const o=i["userHeaderEdit_newData"];"function"==typeof o&&await o(e,t,j),await J(e,t),j.lock(!1),N.disabled=!0,D.disabled=!0}catch(t){console.error(t),await $fgta5.MessageBox.error(t.message),r&&e.Modules.userHeaderList.Section.show()}}(t,e)}),D.addEventListener("click",e=>{!async function(e){if(j.isNew())return;const t=j.getPrimaryInput().value;if("ok"!=await $fgta5.MessageBox.confirm(Module.DELETE_CONFIRM+`id: ${t}`))return;let n=$fgta5.Modal.createMask();try{await async function(e,t){const n=`/${o.moduleName}/header-delete`;try{return await Module.apiCall(n,{id:t,source:S})}catch(e){throw e}}(0,t);e.Modules.userHeaderList.removeCurrentRow(e),e.Modules.userHeaderList.Section.show(),j.lock()}catch(e){console.error(e),await $fgta5.MessageBox.error(e.message)}finally{n.close(),n=null}}(t)}),P.addEventListener("click",e=>{!async function(){if(j.isNew())J();else if(j.isChanged()){if("ok"!=await $fgta5.MessageBox.confirm(Module.RESET_CONFIRM))return;j.reset()}}()}),T.addEventListener("click",e=>{!async function(e){e.Modules.userHeaderList.selectPreviousRow(e)}(t)}),H.addEventListener("click",e=>{!async function(e){e.Modules.userHeaderList.selectNextRow(e)}(t)}),G.addEventListener("click",n=>{!async function(t){const n={Context:o,sectionReturn:I};e.openSection(t,"fRecord-section",n,async()=>{let e=$fgta5.Modal.createMask();try{const e=j.getPrimaryInput().value,o=await Q(t,e);K.innerHTML=o._createby,V.innerHTML=o._createdate,z.innerHTML=o._modifyby,q.innerHTML=o._modifydate;const n=i["userHeaderEdit_addRecordInfo"];"function"==typeof n&&await n(t,o)}catch(e){console.error(e),$fgta5.MessageBox.error(e.message)}finally{e.close(),e=null}})}(t)}),O.addEventListener("click",n=>{!async function(t){const n={Context:o,sectionReturn:I};e.openSection(t,"fLogs-section",n,async()=>{const t=j.getPrimaryInput().value;let n=$fgta5.Modal.createMask();try{const n=`${o.appsUrls.core.url}/logs/list`,a={module:o.moduleName,table:"core.user",id:t},i=await Module.apiCall(n,{criteria:a}),r=document.getElementById("fLogs-section").querySelector("tbody");e.renderLog(r,i.data)}catch(e){console.error(e),$fgta5.MessageBox.error(e.message)}finally{n.close(),n=null}})}(t)}),U.addEventListener("click",n=>{!async function(t){const n={Context:o,sectionReturn:I};e.openSection(t,"fAbout-section",n,async()=>{M.Items["fAbout-section"].Title="About User";const e=document.getElementById("fAbout-section");if(null==document.getElementById("fAbout-section-fdescr")){const t=document.createElement("div");t.setAttribute("id","fAbout-section-fdescr"),t.setAttribute("style","padding: 0 0 10px 0"),t.innerHTML="daftar user";const o=e.querySelector("div[data-topbar]");o.parentNode.insertBefore(t,o.nextSibling)}if(null==document.getElementById("fAbout-section-footer")){const t=document.createElement("div");t.setAttribute("id","fAbout-section-footer"),t.setAttribute("style","border-top: 1px solid #ccc; padding: 5px 0 0 0; margin-top: 50px"),t.innerHTML="This module is generated by fgta5 generator at 11 Oct 2025 04:20",e.appendChild(t)}})}(t)})}async function J(e,t){try{j.newData(t),j.acceptChanges(),j.setAsNewData()}catch(e){throw e}}async function Q(e,t){const n=`/${o.moduleName}/header-open`;try{return await Module.apiCall(n,{id:t})}catch(e){throw e}}async function X(e,t){let n=!1;j.isChanged()?"ok"==await $fgta5.MessageBox.confirm(Module.BACK_CONFIRM)&&(j.reset(),n=!0):n=!0;if(n){j.lock();const e=o.Sections.userHeaderList;M.Items[e].show({direction:1})}}async function Y(e,t){const o=j.getPrimaryInput();o.disabled=!0===t.disabled,void 0!==t.placeholder&&(o.placeholder=t.placeholder),void 0!==t.value&&(o.value=t.value)}var ee=Object.freeze({__proto__:null,Section:W,clearForm:function(e,t){j.clear(t)},disableNextButton:function(e,t=!0){H.disabled=t},disablePrevButton:function(e,t=!0){T.disabled=t},getForm:function(e){return j},getHeaderForm:function(e){return j},init:Z,keyboardAction:function(e,t){"save"==t?(j.acceptInput(),F.click()):"new"==t?(j.acceptInput(),A.click()):"escape"==t?(j.acceptInput(),j.isLocked()||j.isNew()?X():N.click()):"togleEdit"==t?(j.acceptInput(),N.click()):"right"==t?H.click():"left"==t&&T.click()},openSelectedData:async function(e,t){let o=$fgta5.Modal.createMask();try{const o=t.keyvalue,n=await Q(e,o);k.currentOpenedId=o;const a=i["userHeaderEdit_isEditDisabled"];if("function"==typeof a){const t=a(e,n);k.editDisabled=t}Y(e,{disabled:!0}),j.setData(n),j.acceptChanges(),j.lock();const r=i["userHeaderEdit_formOpened"];"function"==typeof r&&r(e,j,k)}catch(e){throw k.currentOpenedId=null,e}finally{o.close(),o=null}}});const te=o.Crsl,oe=o.Sections.userLoginList,ne=te.Items[oe],ae={},ie=new $fgta5.Gridview("userLoginList-tbl"),re=document.getElementById("userLoginList-btn_addrow"),se=new $fgta5.ActionButton("userLoginList-btn_delrow");let ce;const de=ne;async function le(e,t){ne.addEventListener($fgta5.Section.EVT_BACKBUTTONCLICK,async e=>{const t=o.Sections.userHeaderEdit;te.Items[t].show({direction:1})}),ie.addEventListener("nextdata",async t=>{!async function(e,t){const o=t.detail.criteria,n=t.detail.limit,a=t.detail.nextoffset,i=t.detail.sort;await we(e,{criteria:o,limit:n,offset:a,sort:i}),ie.scrollToFooter()}(e,t)}),ie.addEventListener("sorting",async t=>{!async function(e,t){ie.clear();const o=t.detail.sort,n=t.detail.Criteria;we(e,{criteria:n,sort:o})}(e,t)});const n=i.loginList_addTableEvents;"function"==typeof n&&n(e,ie),Module.isMobileDevice()?ie.addEventListener("cellclick",async t=>{pe(e,t)}):ie.addEventListener("celldblclick",async t=>{pe(e,t)}),se.addEventListener("click",e=>{!async function(){const e=ie.getSelected();if(0==e.length)return;if("ok"!=await $fgta5.MessageBox.confirm(`Apakah anda yakin akan menghappus ${e.length} data yang dipilih?`))return;let t=$fgta5.Modal.createMask();try{await async function(e,t){const n=`/${o.moduleName}/login-delete-rows`;try{const e=await Module.apiCall(n,{data:t});if(e.deleted)return!0;throw new Error(e.message)}catch(e){throw e}}(0,e)&&ie.removeSelected()}catch(e){console.error(e),$fgta5.MessageBox.error(e.message)}finally{t.close(),t=null}}()});const a=i.userLoginList_init;"function"==typeof a&&a(e),ae.headerFormLocked=!0}function ue(e,t){const o=ae.SelectedRow;o.previousElementSibling?t.disablePrevButton(e,!1):t.disablePrevButton(e,!0),o.nextElementSibling?t.disableNextButton(e,!1):t.disableNextButton(e,!0)}function fe(e,t){ae.SelectedRow=t}async function ge(e,t){const o=t.getAttribute("keyvalue"),n=t.getAttribute("key"),a=e.Modules.userLoginEdit;a.clearForm(e,"loading...");try{fe(0,t),ae.SelectedRow.keyValue=o,ae.SelectedRow.key=n,await a.openSelectedData(e,{key:n,keyvalue:o})}catch(e){console.error(e),await $fgta5.MessageBox.error(e.message),fe(0,null),ne.show()}ue(e,a)}async function pe(e,t){const o=t.detail.tr;e.Modules.userLoginEdit.Section.show({},t=>{ge(e,o)})}async function we(e,t={}){const{criteria:n={},limit:a=0,offset:i=0,sort:r={}}=t;let s=$fgta5.Modal.createMask();try{const e=await async function(e,t,n,a,i){const r=`/${o.moduleName}/login-list`;try{const e=[];return await Module.apiCall(r,{columns:e,criteria:t,offset:n,limit:a,sort:i})}catch(e){throw e}}(0,n,i,a,r);0===i&&ie.clear(),ie.addRows(e.data),ie.setNext(e.nextoffset,e.limit)}catch(e){console.error(e),$fgta5.MessageBox.error(e.message)}finally{s.close(),s=null}}var ye=Object.freeze({__proto__:null,Section:de,addNewRow:function(e,t){fe(e,ie.addRow(t))},getCurrentRow:function(e){return ae.SelectedRow},getGrid:function(e){return ie},headerLocked:function(e){ae.headerFormLocked=!0},headerUnlocked:function(e){ae.headerFormLocked=!1},init:le,keyboardAction:function(e,t){if("up"==t)ie.previousRecord();else if("down"==t)ie.nextRecord();else if("enter"==t){e.Modules.userLoginEdit.Section.show({},t=>{ge(e,ie.CurrentRow)})}},openList:async function(e,t){const o=t.moduleHeaderEdit;ce=o.getHeaderForm();const n=ce.getPrimaryInput().value,a=i.userLoginList_openList;"function"==typeof a&&a(e,ce);const r={user_id:n},s=ie.getSort();ie.clear(),we(e,{criteria:r,sort:s}),ae.headerFormLocked?(re.setAttribute("disabled",""),se.disabled=!0):(re.removeAttribute("disabled"),se.disabled=!1)},removeCurrentRow:function(e){const t=ae.SelectedRow;ie.removeRow(t)},selectNextRow:function(e){const t=ae.SelectedRow;t.nextElementSibling&&(ie.CurrentRow=t.nextElementSibling,ge(e,t.nextElementSibling))},selectPreviousRow:function(e){const t=ae.SelectedRow;t.previousElementSibling&&(ie.CurrentRow=t.previousElementSibling,ge(e,t.previousElementSibling))},setPagingButton:ue,updateCurrentRow:function(e,t){const o=ae.SelectedRow;try{ie.updateRow(o,t)}catch(e){throw e}}});const me={},be=o.Crsl,Ee=o.Sections.userLoginEdit,Le=be.Items[Ee],ve=o.Source,he="New User",ke="View User",Me="Edit User",_e="Edit",Ie="Lock",Se=new $fgta5.ActionButton("userLoginEdit-btn_edit"),Be=new $fgta5.ActionButton("userLoginEdit-btn_save"),Ce=new $fgta5.ActionButton("userLoginEdit-btn_new","userLogin-addrow"),Re=new $fgta5.ActionButton("userLoginEdit-btn_delete","userLogin-delrow"),$e=new $fgta5.ActionButton("userLoginEdit-btn_reset"),xe=new $fgta5.ActionButton("userLoginEdit-btn_prev"),Ne=new $fgta5.ActionButton("userLoginEdit-btn_next"),Fe=document.getElementById("userLogin-btn_recordstatus"),Ae=document.getElementById("userLogin-btn_logs"),De=new $fgta5.Form("userLoginEdit-frm");De.Inputs["userLoginEdit-obj_userlogin_id"],De.Inputs["userLoginEdit-obj_userlogin_name"],De.Inputs["userLoginEdit-obj_user_id"];const Pe=document.getElementById("fRecord-section-createby"),Te=document.getElementById("fRecord-section-createdate"),He=document.getElementById("fRecord-section-modifyby"),Ge=document.getElementById("fRecord-section-modifydate"),Oe=Le;async function Ue(t,n){Le.addEventListener($fgta5.Section.EVT_BACKBUTTONCLICK,async e=>{Ve()}),De.addEventListener("locked",e=>{!async function(e){Le.Title=ke,Se.setText(_e),Se.disabled=!1,Be.disabled=!0,Ce.disabled=!1,Re.disabled=!0,$e.disabled=!0,xe.disabled=!1,Ne.disabled=!1;const t=i.userLoginEdit_formLocked;"function"==typeof t&&t(e,De,me);me.editDisabled&&(Se.disabled=!0,Ce.disabled=!0)}(t)}),De.addEventListener("unlocked",e=>{!async function(e){De.isNew()?Le.Title=he:Le.Title=Me;Se.setText(Ie),Se.disabled=!1,Be.disabled=!1,Ce.disabled=!0,Re.disabled=!1,$e.disabled=!1,xe.disabled=!0,Ne.disabled=!0;const t=i.userLoginEdit_formUnlocked;"function"==typeof t&&t(e,De)}(t)}),De.render(),Se.addEventListener("click",e=>{!async function(){if(De.isLocked())De.lock(!1);else{if(De.isChanged()||De.isNew())return void await $fgta5.MessageBox.warning(Module.EDIT_WARNING);De.lock(!0)}}()}),Be.addEventListener("click",e=>{!async function(e){const t=i.userLoginEdit_autofill;"function"==typeof t&&await t(e,De);if(!De.validate()){const e=De.getLastError();return void $fgta5.MessageBox.warning(e)}let n;const a=De.isNew();if(a)n=De.getData();else{if(!De.isChanged())return;n=De.getDataChanged()}let r=null;const s=De.getFiles();if(null!=s){r=new FormData;for(let e in s){const t=s[e];r.append(e,t)}}const c=i.userLoginEdit_dataSaving;"function"==typeof c&&await c(e,n,De);let d=$fgta5.Modal.createMask();try{let t;t=a?await async function(e,t,n){const a=`/${o.moduleName}/login-create`;try{return await Module.apiCall(a,{data:t,source:ve},n)}catch(e){throw e}}(0,n,r):await async function(e,t,n){const a=`/${o.moduleName}/login-update`;try{return await Module.apiCall(a,{data:t,source:ve},n)}catch(e){throw e}}(0,n,r);const s=De.getPrimaryInput(),c=t[s.getBindingData()],d=await Ke(e,c);me.currentOpenedId=c,De.AutoID?s.value=c:ze(e,{disabled:!0}),De.setData(d);const l=i["userLoginEdit_dataSaved"];"function"==typeof l&&await l(e,d,De),De.acceptChanges(),a?(Se.disabled=!1,e.Modules.userLoginList.addNewRow(e,d)):e.Modules.userLoginList.updateCurrentRow(e,d)}catch(e){console.error(e),await $fgta5.MessageBox.error(e.message)}finally{d.close(),d=null}}(t)}),Ce.addEventListener("click",e=>{!async function(e,t){const o=t.target.getAttribute("data-sectionsource"),n=e.Modules.userLoginList,a=n.Section.Id,r=o===a;if(r)Le.setSectionReturn(n.Section),await Le.show();else{let e=!1;if(De.isChanged()){"cancel"==await $fgta5.MessageBox.confirm(Module.NEWDATA_CONFIRM)&&(e=!0)}if(e)return}De.AutoID?ze(e,{disabled:!0,placeholder:"[AutoID]"}):ze(e,{disabled:!1,placeholder:"ID"});try{const t=e.Modules.userHeaderEdit,o=t.getHeaderForm().getPrimaryInput();let n={user_id:o.value};const a=i["userLoginEdit_newData"];"function"==typeof a&&await a(e,n,De),await je(e,n),De.lock(!1),Se.disabled=!0,Re.disabled=!0}catch(t){console.error(t),await $fgta5.MessageBox.error(t.message),r&&e.Modules.userLoginList.Section.show()}}(t,e)}),Re.addEventListener("click",e=>{!async function(e){if(De.isNew())return;const t=De.getPrimaryInput().value;if("ok"!=await $fgta5.MessageBox.confirm(Module.DELETE_CONFIRM+`id: ${t}`))return;let n=$fgta5.Modal.createMask();try{await async function(e,t){const n=`/${o.moduleName}/login-delete`;try{return await Module.apiCall(n,{id:t,source:ve})}catch(e){throw e}}(0,t);e.Modules.userLoginList.removeCurrentRow(e),e.Modules.userLoginList.Section.show(),De.lock()}catch(e){console.error(e),await $fgta5.MessageBox.error(e.message)}finally{n.close(),n=null}}(t)}),$e.addEventListener("click",e=>{!async function(){if(De.isNew())je();else if(De.isChanged()){if("ok"!=await $fgta5.MessageBox.confirm(Module.RESET_CONFIRM))return;De.reset()}}()}),xe.addEventListener("click",e=>{!async function(e){e.Modules.userLoginList.selectPreviousRow(e)}(t)}),Ne.addEventListener("click",e=>{!async function(e){e.Modules.userLoginList.selectNextRow(e)}(t)}),Fe.addEventListener("click",n=>{!async function(t){const n={Context:o,sectionReturn:Le};e.openSection(t,"fRecord-section",n,async()=>{let e=$fgta5.Modal.createMask();try{const e=De.getPrimaryInput().value,o=await Ke(t,e);Pe.innerHTML=o._createby,Te.innerHTML=o._createdate,He.innerHTML=o._modifyby,Ge.innerHTML=o._modifydate;const n=i["userLoginEdit_addRecordInfo"];"function"==typeof n&&await n(t,o)}catch(e){console.error(e),$fgta5.MessageBox.error(e.message)}finally{e.close(),e=null}})}(t)}),Ae.addEventListener("click",n=>{!async function(t){const n={Context:o,sectionReturn:Le};e.openSection(t,"fLogs-section",n,async()=>{const t=De.getPrimaryInput().value;let n=$fgta5.Modal.createMask();try{const n=`${o.appsUrls.core.url}/logs/list`,a={module:o.moduleName,table:"core.userlogin",id:t},i=await Module.apiCall(n,{criteria:a}),r=document.getElementById("fLogs-section").querySelector("tbody");e.renderLog(r,i.data)}catch(e){console.error(e),$fgta5.MessageBox.error(e.message)}finally{n.close(),n=null}})}(t)}),me.headerFormLocked=!0,me.editDisabled=!1}async function je(e,t){try{De.newData(t),De.acceptChanges(),De.setAsNewData()}catch(e){throw e}}async function Ke(e,t){const n=`/${o.moduleName}/login-open`;try{return await Module.apiCall(n,{id:t})}catch(e){throw e}}async function Ve(e,t){let n=!1;De.isChanged()?"ok"==await $fgta5.MessageBox.confirm(Module.BACK_CONFIRM)&&(De.reset(),n=!0):n=!0;if(n){De.lock();const e=o.Sections.userLoginList;be.Items[e].show({direction:1})}}async function ze(e,t){const o=De.getPrimaryInput();o.disabled=!0===t.disabled,void 0!==t.placeholder&&(o.placeholder=t.placeholder),void 0!==t.value&&(o.value=t.value)}var qe=Object.freeze({__proto__:null,Section:Oe,clearForm:function(e,t){De.clear(t)},disableNextButton:function(e,t=!0){Ne.disabled=t},disablePrevButton:function(e,t=!0){xe.disabled=t},getForm:function(e){return De},headerLocked:function(e){me.headerFormLocked=!0,me.editDisabled=!0,Ce.disabled=!0},headerUnlocked:function(e){me.headerFormLocked=!1,me.editDisabled=!1,Ce.disabled=!1},init:Ue,keyboardAction:function(e,t){"save"==t?(De.acceptInput(),Be.click()):"new"==t?(De.acceptInput(),Ce.click()):"escape"==t?(De.acceptInput(),De.isLocked()||De.isNew()?Ve():Se.click()):"togleEdit"==t?(De.acceptInput(),Se.click()):"right"==t?Ne.click():"left"==t&&xe.click()},openSelectedData:async function(e,t){let o=$fgta5.Modal.createMask();try{const o=t.keyvalue,n=await Ke(e,o);if(me.currentOpenedId=o,!me.headerFormLocked){const t=i["userLoginEdit_isEditDisabled"];if("function"==typeof t){const o=t(e,n);me.editDisabled=o}}ze(e,{disabled:!0}),De.setData(n),De.acceptChanges(),De.lock();const a=i["userLoginEdit_formOpened"];"function"==typeof a&&a(e,De,me)}catch(e){throw me.currentOpenedId=null,e}finally{o.close(),o=null}}});const We=o.Crsl,Ze=o.Sections.userPropList,Je=We.Items[Ze],Qe={},Xe=new $fgta5.Gridview("userPropList-tbl"),Ye=document.getElementById("userPropList-btn_addrow"),et=new $fgta5.ActionButton("userPropList-btn_delrow");let tt;const ot=Je;async function nt(e,t){Je.addEventListener($fgta5.Section.EVT_BACKBUTTONCLICK,async e=>{const t=o.Sections.userHeaderEdit;We.Items[t].show({direction:1})}),Xe.addEventListener("nextdata",async t=>{!async function(e,t){const o=t.detail.criteria,n=t.detail.limit,a=t.detail.nextoffset,i=t.detail.sort;await ct(e,{criteria:o,limit:n,offset:a,sort:i}),Xe.scrollToFooter()}(e,t)}),Xe.addEventListener("sorting",async t=>{!async function(e,t){Xe.clear();const o=t.detail.sort,n=t.detail.Criteria;ct(e,{criteria:n,sort:o})}(e,t)});const n=i.propList_addTableEvents;"function"==typeof n&&n(e,Xe),Module.isMobileDevice()?Xe.addEventListener("cellclick",async t=>{st(e,t)}):Xe.addEventListener("celldblclick",async t=>{st(e,t)}),et.addEventListener("click",e=>{!async function(){const e=Xe.getSelected();if(0==e.length)return;if("ok"!=await $fgta5.MessageBox.confirm(`Apakah anda yakin akan menghappus ${e.length} data yang dipilih?`))return;let t=$fgta5.Modal.createMask();try{await async function(e,t){const n=`/${o.moduleName}/prop-delete-rows`;try{const e=await Module.apiCall(n,{data:t});if(e.deleted)return!0;throw new Error(e.message)}catch(e){throw e}}(0,e)&&Xe.removeSelected()}catch(e){console.error(e),$fgta5.MessageBox.error(e.message)}finally{t.close(),t=null}}()});const a=i.userPropList_init;"function"==typeof a&&a(e),Qe.headerFormLocked=!0}function at(e,t){const o=Qe.SelectedRow;o.previousElementSibling?t.disablePrevButton(e,!1):t.disablePrevButton(e,!0),o.nextElementSibling?t.disableNextButton(e,!1):t.disableNextButton(e,!0)}function it(e,t){Qe.SelectedRow=t}async function rt(e,t){const o=t.getAttribute("keyvalue"),n=t.getAttribute("key"),a=e.Modules.userPropEdit;a.clearForm(e,"loading...");try{it(0,t),Qe.SelectedRow.keyValue=o,Qe.SelectedRow.key=n,await a.openSelectedData(e,{key:n,keyvalue:o})}catch(e){console.error(e),await $fgta5.MessageBox.error(e.message),it(0,null),Je.show()}at(e,a)}async function st(e,t){const o=t.detail.tr;e.Modules.userPropEdit.Section.show({},t=>{rt(e,o)})}async function ct(e,t={}){const{criteria:n={},limit:a=0,offset:i=0,sort:r={}}=t;let s=$fgta5.Modal.createMask();try{const e=await async function(e,t,n,a,i){const r=`/${o.moduleName}/prop-list`;try{const e=[];return await Module.apiCall(r,{columns:e,criteria:t,offset:n,limit:a,sort:i})}catch(e){throw e}}(0,n,i,a,r);0===i&&Xe.clear(),Xe.addRows(e.data),Xe.setNext(e.nextoffset,e.limit)}catch(e){console.error(e),$fgta5.MessageBox.error(e.message)}finally{s.close(),s=null}}var dt=Object.freeze({__proto__:null,Section:ot,addNewRow:function(e,t){it(e,Xe.addRow(t))},getCurrentRow:function(e){return Qe.SelectedRow},getGrid:function(e){return Xe},headerLocked:function(e){Qe.headerFormLocked=!0},headerUnlocked:function(e){Qe.headerFormLocked=!1},init:nt,keyboardAction:function(e,t){if("up"==t)Xe.previousRecord();else if("down"==t)Xe.nextRecord();else if("enter"==t){e.Modules.userPropEdit.Section.show({},t=>{rt(e,Xe.CurrentRow)})}},openList:async function(e,t){const o=t.moduleHeaderEdit;tt=o.getHeaderForm();const n=tt.getPrimaryInput().value,a=i.userPropList_openList;"function"==typeof a&&a(e,tt);const r={user_id:n},s=Xe.getSort();Xe.clear(),ct(e,{criteria:r,sort:s}),Qe.headerFormLocked?(Ye.setAttribute("disabled",""),et.disabled=!0):(Ye.removeAttribute("disabled"),et.disabled=!1)},removeCurrentRow:function(e){const t=Qe.SelectedRow;Xe.removeRow(t)},selectNextRow:function(e){const t=Qe.SelectedRow;t.nextElementSibling&&(Xe.CurrentRow=t.nextElementSibling,rt(e,t.nextElementSibling))},selectPreviousRow:function(e){const t=Qe.SelectedRow;t.previousElementSibling&&(Xe.CurrentRow=t.previousElementSibling,rt(e,t.previousElementSibling))},setPagingButton:at,updateCurrentRow:function(e,t){const o=Qe.SelectedRow;try{Xe.updateRow(o,t)}catch(e){throw e}}});const lt={},ut=o.Crsl,ft=o.Sections.userPropEdit,gt=ut.Items[ft],pt=o.Source,wt="New User",yt="View User",mt="Edit User",bt="Edit",Et="Lock",Lt=new $fgta5.ActionButton("userPropEdit-btn_edit"),vt=new $fgta5.ActionButton("userPropEdit-btn_save"),ht=new $fgta5.ActionButton("userPropEdit-btn_new","userProp-addrow"),kt=new $fgta5.ActionButton("userPropEdit-btn_delete","userProp-delrow"),Mt=new $fgta5.ActionButton("userPropEdit-btn_reset"),_t=new $fgta5.ActionButton("userPropEdit-btn_prev"),It=new $fgta5.ActionButton("userPropEdit-btn_next"),St=document.getElementById("userProp-btn_recordstatus"),Bt=document.getElementById("userProp-btn_logs"),Ct=new $fgta5.Form("userPropEdit-frm");Ct.Inputs["userPropEdit-obj_userprop_id"],Ct.Inputs["userPropEdit-obj_userprop_name"],Ct.Inputs["userPropEdit-obj_userprop_value"],Ct.Inputs["userPropEdit-obj_user_id"];const Rt=document.getElementById("fRecord-section-createby"),$t=document.getElementById("fRecord-section-createdate"),xt=document.getElementById("fRecord-section-modifyby"),Nt=document.getElementById("fRecord-section-modifydate"),Ft=gt;async function At(t,n){gt.addEventListener($fgta5.Section.EVT_BACKBUTTONCLICK,async e=>{Tt()}),Ct.addEventListener("locked",e=>{!async function(e){gt.Title=yt,Lt.setText(bt),Lt.disabled=!1,vt.disabled=!0,ht.disabled=!1,kt.disabled=!0,Mt.disabled=!0,_t.disabled=!1,It.disabled=!1;const t=i.userPropEdit_formLocked;"function"==typeof t&&t(e,Ct,lt);lt.editDisabled&&(Lt.disabled=!0,ht.disabled=!0)}(t)}),Ct.addEventListener("unlocked",e=>{!async function(e){Ct.isNew()?gt.Title=wt:gt.Title=mt;Lt.setText(Et),Lt.disabled=!1,vt.disabled=!1,ht.disabled=!0,kt.disabled=!1,Mt.disabled=!1,_t.disabled=!0,It.disabled=!0;const t=i.userPropEdit_formUnlocked;"function"==typeof t&&t(e,Ct)}(t)}),Ct.render(),Lt.addEventListener("click",e=>{!async function(){if(Ct.isLocked())Ct.lock(!1);else{if(Ct.isChanged()||Ct.isNew())return void await $fgta5.MessageBox.warning(Module.EDIT_WARNING);Ct.lock(!0)}}()}),vt.addEventListener("click",e=>{!async function(e){const t=i.userPropEdit_autofill;"function"==typeof t&&await t(e,Ct);if(!Ct.validate()){const e=Ct.getLastError();return void $fgta5.MessageBox.warning(e)}let n;const a=Ct.isNew();if(a)n=Ct.getData();else{if(!Ct.isChanged())return;n=Ct.getDataChanged()}let r=null;const s=Ct.getFiles();if(null!=s){r=new FormData;for(let e in s){const t=s[e];r.append(e,t)}}const c=i.userPropEdit_dataSaving;"function"==typeof c&&await c(e,n,Ct);let d=$fgta5.Modal.createMask();try{let t;t=a?await async function(e,t,n){const a=`/${o.moduleName}/prop-create`;try{return await Module.apiCall(a,{data:t,source:pt},n)}catch(e){throw e}}(0,n,r):await async function(e,t,n){const a=`/${o.moduleName}/prop-update`;try{return await Module.apiCall(a,{data:t,source:pt},n)}catch(e){throw e}}(0,n,r);const s=Ct.getPrimaryInput(),c=t[s.getBindingData()],d=await Pt(e,c);lt.currentOpenedId=c,Ct.AutoID?s.value=c:Ht(e,{disabled:!0}),Ct.setData(d);const l=i["userPropEdit_dataSaved"];"function"==typeof l&&await l(e,d,Ct),Ct.acceptChanges(),a?(Lt.disabled=!1,e.Modules.userPropList.addNewRow(e,d)):e.Modules.userPropList.updateCurrentRow(e,d)}catch(e){console.error(e),await $fgta5.MessageBox.error(e.message)}finally{d.close(),d=null}}(t)}),ht.addEventListener("click",e=>{!async function(e,t){const o=t.target.getAttribute("data-sectionsource"),n=e.Modules.userPropList,a=n.Section.Id,r=o===a;if(r)gt.setSectionReturn(n.Section),await gt.show();else{let e=!1;if(Ct.isChanged()){"cancel"==await $fgta5.MessageBox.confirm(Module.NEWDATA_CONFIRM)&&(e=!0)}if(e)return}Ct.AutoID?Ht(e,{disabled:!0,placeholder:"[AutoID]"}):Ht(e,{disabled:!1,placeholder:"ID"});try{const t=e.Modules.userHeaderEdit,o=t.getHeaderForm().getPrimaryInput();let n={user_id:o.value};const a=i["userPropEdit_newData"];"function"==typeof a&&await a(e,n,Ct),await Dt(e,n),Ct.lock(!1),Lt.disabled=!0,kt.disabled=!0}catch(t){console.error(t),await $fgta5.MessageBox.error(t.message),r&&e.Modules.userPropList.Section.show()}}(t,e)}),kt.addEventListener("click",e=>{!async function(e){if(Ct.isNew())return;const t=Ct.getPrimaryInput().value;if("ok"!=await $fgta5.MessageBox.confirm(Module.DELETE_CONFIRM+`id: ${t}`))return;let n=$fgta5.Modal.createMask();try{await async function(e,t){const n=`/${o.moduleName}/prop-delete`;try{return await Module.apiCall(n,{id:t,source:pt})}catch(e){throw e}}(0,t);e.Modules.userPropList.removeCurrentRow(e),e.Modules.userPropList.Section.show(),Ct.lock()}catch(e){console.error(e),await $fgta5.MessageBox.error(e.message)}finally{n.close(),n=null}}(t)}),Mt.addEventListener("click",e=>{!async function(){if(Ct.isNew())Dt();else if(Ct.isChanged()){if("ok"!=await $fgta5.MessageBox.confirm(Module.RESET_CONFIRM))return;Ct.reset()}}()}),_t.addEventListener("click",e=>{!async function(e){e.Modules.userPropList.selectPreviousRow(e)}(t)}),It.addEventListener("click",e=>{!async function(e){e.Modules.userPropList.selectNextRow(e)}(t)}),St.addEventListener("click",n=>{!async function(t){const n={Context:o,sectionReturn:gt};e.openSection(t,"fRecord-section",n,async()=>{let e=$fgta5.Modal.createMask();try{const e=Ct.getPrimaryInput().value,o=await Pt(t,e);Rt.innerHTML=o._createby,$t.innerHTML=o._createdate,xt.innerHTML=o._modifyby,Nt.innerHTML=o._modifydate;const n=i["userPropEdit_addRecordInfo"];"function"==typeof n&&await n(t,o)}catch(e){console.error(e),$fgta5.MessageBox.error(e.message)}finally{e.close(),e=null}})}(t)}),Bt.addEventListener("click",n=>{!async function(t){const n={Context:o,sectionReturn:gt};e.openSection(t,"fLogs-section",n,async()=>{const t=Ct.getPrimaryInput().value;let n=$fgta5.Modal.createMask();try{const n=`${o.appsUrls.core.url}/logs/list`,a={module:o.moduleName,table:"core.userprop",id:t},i=await Module.apiCall(n,{criteria:a}),r=document.getElementById("fLogs-section").querySelector("tbody");e.renderLog(r,i.data)}catch(e){console.error(e),$fgta5.MessageBox.error(e.message)}finally{n.close(),n=null}})}(t)}),lt.headerFormLocked=!0,lt.editDisabled=!1}async function Dt(e,t){try{Ct.newData(t),Ct.acceptChanges(),Ct.setAsNewData()}catch(e){throw e}}async function Pt(e,t){const n=`/${o.moduleName}/prop-open`;try{return await Module.apiCall(n,{id:t})}catch(e){throw e}}async function Tt(e,t){let n=!1;Ct.isChanged()?"ok"==await $fgta5.MessageBox.confirm(Module.BACK_CONFIRM)&&(Ct.reset(),n=!0):n=!0;if(n){Ct.lock();const e=o.Sections.userPropList;ut.Items[e].show({direction:1})}}async function Ht(e,t){const o=Ct.getPrimaryInput();o.disabled=!0===t.disabled,void 0!==t.placeholder&&(o.placeholder=t.placeholder),void 0!==t.value&&(o.value=t.value)}var Gt=Object.freeze({__proto__:null,Section:Ft,clearForm:function(e,t){Ct.clear(t)},disableNextButton:function(e,t=!0){It.disabled=t},disablePrevButton:function(e,t=!0){_t.disabled=t},getForm:function(e){return Ct},headerLocked:function(e){lt.headerFormLocked=!0,lt.editDisabled=!0,ht.disabled=!0},headerUnlocked:function(e){lt.headerFormLocked=!1,lt.editDisabled=!1,ht.disabled=!1},init:At,keyboardAction:function(e,t){"save"==t?(Ct.acceptInput(),vt.click()):"new"==t?(Ct.acceptInput(),ht.click()):"escape"==t?(Ct.acceptInput(),Ct.isLocked()||Ct.isNew()?Tt():Lt.click()):"togleEdit"==t?(Ct.acceptInput(),Lt.click()):"right"==t?It.click():"left"==t&&_t.click()},openSelectedData:async function(e,t){let o=$fgta5.Modal.createMask();try{const o=t.keyvalue,n=await Pt(e,o);if(lt.currentOpenedId=o,!lt.headerFormLocked){const t=i["userPropEdit_isEditDisabled"];if("function"==typeof t){const o=t(e,n);lt.editDisabled=o}}Ht(e,{disabled:!0}),Ct.setData(n),Ct.acceptChanges(),Ct.lock();const a=i["userPropEdit_formOpened"];"function"==typeof a&&a(e,Ct,lt)}catch(e){throw lt.currentOpenedId=null,e}finally{o.close(),o=null}}});const Ot=o.Crsl,Ut=o.Sections.userGroupList,jt=Ot.Items[Ut],Kt={},Vt=new $fgta5.Gridview("userGroupList-tbl"),zt=document.getElementById("userGroupList-btn_addrow"),qt=new $fgta5.ActionButton("userGroupList-btn_delrow");let Wt;const Zt=jt;async function Jt(e,t){jt.addEventListener($fgta5.Section.EVT_BACKBUTTONCLICK,async e=>{const t=o.Sections.userHeaderEdit;Ot.Items[t].show({direction:1})}),Vt.addEventListener("nextdata",async t=>{!async function(e,t){const o=t.detail.criteria,n=t.detail.limit,a=t.detail.nextoffset,i=t.detail.sort;await to(e,{criteria:o,limit:n,offset:a,sort:i}),Vt.scrollToFooter()}(e,t)}),Vt.addEventListener("sorting",async t=>{!async function(e,t){Vt.clear();const o=t.detail.sort,n=t.detail.Criteria;to(e,{criteria:n,sort:o})}(e,t)});const n=i.groupList_addTableEvents;"function"==typeof n&&n(e,Vt),Module.isMobileDevice()?Vt.addEventListener("cellclick",async t=>{eo(e,t)}):Vt.addEventListener("celldblclick",async t=>{eo(e,t)}),qt.addEventListener("click",e=>{!async function(){const e=Vt.getSelected();if(0==e.length)return;if("ok"!=await $fgta5.MessageBox.confirm(`Apakah anda yakin akan menghappus ${e.length} data yang dipilih?`))return;let t=$fgta5.Modal.createMask();try{await async function(e,t){const n=`/${o.moduleName}/group-delete-rows`;try{const e=await Module.apiCall(n,{data:t});if(e.deleted)return!0;throw new Error(e.message)}catch(e){throw e}}(0,e)&&Vt.removeSelected()}catch(e){console.error(e),$fgta5.MessageBox.error(e.message)}finally{t.close(),t=null}}()});const a=i.userGroupList_init;"function"==typeof a&&a(e),Kt.headerFormLocked=!0}function Qt(e,t){const o=Kt.SelectedRow;o.previousElementSibling?t.disablePrevButton(e,!1):t.disablePrevButton(e,!0),o.nextElementSibling?t.disableNextButton(e,!1):t.disableNextButton(e,!0)}function Xt(e,t){Kt.SelectedRow=t}async function Yt(e,t){const o=t.getAttribute("keyvalue"),n=t.getAttribute("key"),a=e.Modules.userGroupEdit;a.clearForm(e,"loading...");try{Xt(0,t),Kt.SelectedRow.keyValue=o,Kt.SelectedRow.key=n,await a.openSelectedData(e,{key:n,keyvalue:o})}catch(e){console.error(e),await $fgta5.MessageBox.error(e.message),Xt(0,null),jt.show()}Qt(e,a)}async function eo(e,t){const o=t.detail.tr;e.Modules.userGroupEdit.Section.show({},t=>{Yt(e,o)})}async function to(e,t={}){const{criteria:n={},limit:a=0,offset:i=0,sort:r={}}=t;let s=$fgta5.Modal.createMask();try{const e=await async function(e,t,n,a,i){const r=`/${o.moduleName}/group-list`;try{const e=[];return await Module.apiCall(r,{columns:e,criteria:t,offset:n,limit:a,sort:i})}catch(e){throw e}}(0,n,i,a,r);0===i&&Vt.clear(),Vt.addRows(e.data),Vt.setNext(e.nextoffset,e.limit)}catch(e){console.error(e),$fgta5.MessageBox.error(e.message)}finally{s.close(),s=null}}var oo=Object.freeze({__proto__:null,Section:Zt,addNewRow:function(e,t){Xt(e,Vt.addRow(t))},getCurrentRow:function(e){return Kt.SelectedRow},getGrid:function(e){return Vt},headerLocked:function(e){Kt.headerFormLocked=!0},headerUnlocked:function(e){Kt.headerFormLocked=!1},init:Jt,keyboardAction:function(e,t){if("up"==t)Vt.previousRecord();else if("down"==t)Vt.nextRecord();else if("enter"==t){e.Modules.userGroupEdit.Section.show({},t=>{Yt(e,Vt.CurrentRow)})}},openList:async function(e,t){const o=t.moduleHeaderEdit;Wt=o.getHeaderForm();const n=Wt.getPrimaryInput().value,a=i.userGroupList_openList;"function"==typeof a&&a(e,Wt);const r={user_id:n},s=Vt.getSort();Vt.clear(),to(e,{criteria:r,sort:s}),Kt.headerFormLocked?(zt.setAttribute("disabled",""),qt.disabled=!0):(zt.removeAttribute("disabled"),qt.disabled=!1)},removeCurrentRow:function(e){const t=Kt.SelectedRow;Vt.removeRow(t)},selectNextRow:function(e){const t=Kt.SelectedRow;t.nextElementSibling&&(Vt.CurrentRow=t.nextElementSibling,Yt(e,t.nextElementSibling))},selectPreviousRow:function(e){const t=Kt.SelectedRow;t.previousElementSibling&&(Vt.CurrentRow=t.previousElementSibling,Yt(e,t.previousElementSibling))},setPagingButton:Qt,updateCurrentRow:function(e,t){const o=Kt.SelectedRow;try{Vt.updateRow(o,t)}catch(e){throw e}}});const no={},ao=o.Crsl,io=o.Sections.userGroupEdit,ro=ao.Items[io],so=o.Source,co="New User",lo="View User",uo="Edit User",fo="Edit",go="Lock",po=new $fgta5.ActionButton("userGroupEdit-btn_edit"),wo=new $fgta5.ActionButton("userGroupEdit-btn_save"),yo=new $fgta5.ActionButton("userGroupEdit-btn_new","userGroup-addrow"),mo=new $fgta5.ActionButton("userGroupEdit-btn_delete","userGroup-delrow"),bo=new $fgta5.ActionButton("userGroupEdit-btn_reset"),Eo=new $fgta5.ActionButton("userGroupEdit-btn_prev"),Lo=new $fgta5.ActionButton("userGroupEdit-btn_next"),vo=document.getElementById("userGroup-btn_recordstatus"),ho=document.getElementById("userGroup-btn_logs"),ko=new $fgta5.Form("userGroupEdit-frm");ko.Inputs["userGroupEdit-obj_usergroup_id"];const Mo=ko.Inputs["userGroupEdit-obj_group_id"];ko.Inputs["userGroupEdit-obj_usergroup_isdisabled"],ko.Inputs["userGroupEdit-obj_user_id"];const _o=document.getElementById("fRecord-section-createby"),Io=document.getElementById("fRecord-section-createdate"),So=document.getElementById("fRecord-section-modifyby"),Bo=document.getElementById("fRecord-section-modifydate"),Co=ro;async function Ro(t,n){ro.addEventListener($fgta5.Section.EVT_BACKBUTTONCLICK,async e=>{No()}),ko.addEventListener("locked",e=>{!async function(e){ro.Title=lo,po.setText(fo),po.disabled=!1,wo.disabled=!0,yo.disabled=!1,mo.disabled=!0,bo.disabled=!0,Eo.disabled=!1,Lo.disabled=!1;const t=i.userGroupEdit_formLocked;"function"==typeof t&&t(e,ko,no);no.editDisabled&&(po.disabled=!0,yo.disabled=!0)}(t)}),ko.addEventListener("unlocked",e=>{!async function(e){ko.isNew()?ro.Title=co:ro.Title=uo;po.setText(go),po.disabled=!1,wo.disabled=!1,yo.disabled=!0,mo.disabled=!1,bo.disabled=!1,Eo.disabled=!0,Lo.disabled=!0;const t=i.userGroupEdit_formUnlocked;"function"==typeof t&&t(e,ko)}(t)}),ko.render(),po.addEventListener("click",e=>{!async function(){if(ko.isLocked())ko.lock(!1);else{if(ko.isChanged()||ko.isNew())return void await $fgta5.MessageBox.warning(Module.EDIT_WARNING);ko.lock(!0)}}()}),wo.addEventListener("click",e=>{!async function(e){const t=i.userGroupEdit_autofill;"function"==typeof t&&await t(e,ko);if(!ko.validate()){const e=ko.getLastError();return void $fgta5.MessageBox.warning(e)}let n;const a=ko.isNew();if(a)n=ko.getData();else{if(!ko.isChanged())return;n=ko.getDataChanged()}let r=null;const s=ko.getFiles();if(null!=s){r=new FormData;for(let e in s){const t=s[e];r.append(e,t)}}const c=i.userGroupEdit_dataSaving;"function"==typeof c&&await c(e,n,ko);let d=$fgta5.Modal.createMask();try{let t;t=a?await async function(e,t,n){const a=`/${o.moduleName}/group-create`;try{return await Module.apiCall(a,{data:t,source:so},n)}catch(e){throw e}}(0,n,r):await async function(e,t,n){const a=`/${o.moduleName}/group-update`;try{return await Module.apiCall(a,{data:t,source:so},n)}catch(e){throw e}}(0,n,r);const s=ko.getPrimaryInput(),c=t[s.getBindingData()],d=await xo(e,c);no.currentOpenedId=c,ko.AutoID?s.value=c:Fo(e,{disabled:!0}),ko.setData(d);const l=i["userGroupEdit_dataSaved"];"function"==typeof l&&await l(e,d,ko),ko.acceptChanges(),a?(po.disabled=!1,e.Modules.userGroupList.addNewRow(e,d)):e.Modules.userGroupList.updateCurrentRow(e,d)}catch(e){console.error(e),await $fgta5.MessageBox.error(e.message)}finally{d.close(),d=null}}(t)}),yo.addEventListener("click",e=>{!async function(e,t){const o=t.target.getAttribute("data-sectionsource"),n=e.Modules.userGroupList,a=n.Section.Id,r=o===a;if(r)ro.setSectionReturn(n.Section),await ro.show();else{let e=!1;if(ko.isChanged()){"cancel"==await $fgta5.MessageBox.confirm(Module.NEWDATA_CONFIRM)&&(e=!0)}if(e)return}ko.AutoID?Fo(e,{disabled:!0,placeholder:"[AutoID]"}):Fo(e,{disabled:!1,placeholder:"ID"});try{const t=e.Modules.userHeaderEdit,o=t.getHeaderForm().getPrimaryInput();let n={user_id:o.value};const a=i["userGroupEdit_newData"];"function"==typeof a&&await a(e,n,ko),await $o(e,n),ko.lock(!1),po.disabled=!0,mo.disabled=!0}catch(t){console.error(t),await $fgta5.MessageBox.error(t.message),r&&e.Modules.userGroupList.Section.show()}}(t,e)}),mo.addEventListener("click",e=>{!async function(e){if(ko.isNew())return;const t=ko.getPrimaryInput().value;if("ok"!=await $fgta5.MessageBox.confirm(Module.DELETE_CONFIRM+`id: ${t}`))return;let n=$fgta5.Modal.createMask();try{await async function(e,t){const n=`/${o.moduleName}/group-delete`;try{return await Module.apiCall(n,{id:t,source:so})}catch(e){throw e}}(0,t);e.Modules.userGroupList.removeCurrentRow(e),e.Modules.userGroupList.Section.show(),ko.lock()}catch(e){console.error(e),await $fgta5.MessageBox.error(e.message)}finally{n.close(),n=null}}(t)}),bo.addEventListener("click",e=>{!async function(){if(ko.isNew())$o();else if(ko.isChanged()){if("ok"!=await $fgta5.MessageBox.confirm(Module.RESET_CONFIRM))return;ko.reset()}}()}),Eo.addEventListener("click",e=>{!async function(e){e.Modules.userGroupList.selectPreviousRow(e)}(t)}),Lo.addEventListener("click",e=>{!async function(e){e.Modules.userGroupList.selectNextRow(e)}(t)}),vo.addEventListener("click",n=>{!async function(t){const n={Context:o,sectionReturn:ro};e.openSection(t,"fRecord-section",n,async()=>{let e=$fgta5.Modal.createMask();try{const e=ko.getPrimaryInput().value,o=await xo(t,e);_o.innerHTML=o._createby,Io.innerHTML=o._createdate,So.innerHTML=o._modifyby,Bo.innerHTML=o._modifydate;const n=i["userGroupEdit_addRecordInfo"];"function"==typeof n&&await n(t,o)}catch(e){console.error(e),$fgta5.MessageBox.error(e.message)}finally{e.close(),e=null}})}(t)}),ho.addEventListener("click",n=>{!async function(t){const n={Context:o,sectionReturn:ro};e.openSection(t,"fLogs-section",n,async()=>{const t=ko.getPrimaryInput().value;let n=$fgta5.Modal.createMask();try{const n=`${o.appsUrls.core.url}/logs/list`,a={module:o.moduleName,table:"core.usergroup",id:t},i=await Module.apiCall(n,{criteria:a}),r=document.getElementById("fLogs-section").querySelector("tbody");e.renderLog(r,i.data)}catch(e){console.error(e),$fgta5.MessageBox.error(e.message)}finally{n.close(),n=null}})}(t)}),no.headerFormLocked=!0,no.editDisabled=!1,Mo.addEventListener("selecting",async e=>{if("function"==typeof fn_obj_group_id_selecting)fn_obj_group_id_selecting(t,Mo,ko,e);else{const a=e.detail.sender,r=e.detail.dialog,s=null!=e.detail.searchtext?e.detail.searchtext:"",c=`${o.appsUrls.core.url}/group/header-list`,d={searchtext:s},l=i["obj_group_id_selecting_criteria"];"function"==typeof fn_selecting_criteria&&l(t,Mo,d),a.wait();try{const t=await Module.apiCall(c,{criteria:d,offset:e.detail.offset,limit:e.detail.limit});for(var n of t.data)e.detail.addRow(n.group_id,n.group_name,n);r.setNext(t.nextoffset,t.limit)}catch(e){$fgta5.MessageBox.error(e.message)}finally{a.wait(!1)}}})}async function $o(e,t){try{ko.newData(t),ko.acceptChanges(),ko.setAsNewData()}catch(e){throw e}}async function xo(e,t){const n=`/${o.moduleName}/group-open`;try{return await Module.apiCall(n,{id:t})}catch(e){throw e}}async function No(e,t){let n=!1;ko.isChanged()?"ok"==await $fgta5.MessageBox.confirm(Module.BACK_CONFIRM)&&(ko.reset(),n=!0):n=!0;if(n){ko.lock();const e=o.Sections.userGroupList;ao.Items[e].show({direction:1})}}async function Fo(e,t){const o=ko.getPrimaryInput();o.disabled=!0===t.disabled,void 0!==t.placeholder&&(o.placeholder=t.placeholder),void 0!==t.value&&(o.value=t.value)}var Ao=Object.freeze({__proto__:null,Section:Co,clearForm:function(e,t){ko.clear(t)},disableNextButton:function(e,t=!0){Lo.disabled=t},disablePrevButton:function(e,t=!0){Eo.disabled=t},getForm:function(e){return ko},headerLocked:function(e){no.headerFormLocked=!0,no.editDisabled=!0,yo.disabled=!0},headerUnlocked:function(e){no.headerFormLocked=!1,no.editDisabled=!1,yo.disabled=!1},init:Ro,keyboardAction:function(e,t){"save"==t?(ko.acceptInput(),wo.click()):"new"==t?(ko.acceptInput(),yo.click()):"escape"==t?(ko.acceptInput(),ko.isLocked()||ko.isNew()?No():po.click()):"togleEdit"==t?(ko.acceptInput(),po.click()):"right"==t?Lo.click():"left"==t&&Eo.click()},openSelectedData:async function(e,t){let o=$fgta5.Modal.createMask();try{Mo.clear();const o=t.keyvalue,n=await xo(e,o);if(no.currentOpenedId=o,!no.headerFormLocked){const t=i["userGroupEdit_isEditDisabled"];if("function"==typeof t){const o=t(e,n);no.editDisabled=o}}Fo(e,{disabled:!0}),ko.setData(n),ko.acceptChanges(),ko.lock();const a=i["userGroupEdit_formOpened"];"function"==typeof a&&a(e,ko,no)}catch(e){throw no.currentOpenedId=null,e}finally{o.close(),o=null}}});const Do=o.Crsl,Po=o.Sections.userFavouriteList,To=Do.Items[Po],Ho={},Go=new $fgta5.Gridview("userFavouriteList-tbl"),Oo=document.getElementById("userFavouriteList-btn_addrow"),Uo=new $fgta5.ActionButton("userFavouriteList-btn_delrow");let jo;const Ko=To;async function Vo(e,t){To.addEventListener($fgta5.Section.EVT_BACKBUTTONCLICK,async e=>{const t=o.Sections.userHeaderEdit;Do.Items[t].show({direction:1})}),Go.addEventListener("nextdata",async t=>{!async function(e,t){const o=t.detail.criteria,n=t.detail.limit,a=t.detail.nextoffset,i=t.detail.sort;await Jo(e,{criteria:o,limit:n,offset:a,sort:i}),Go.scrollToFooter()}(e,t)}),Go.addEventListener("sorting",async t=>{!async function(e,t){Go.clear();const o=t.detail.sort,n=t.detail.Criteria;Jo(e,{criteria:n,sort:o})}(e,t)});const n=i.favouriteList_addTableEvents;"function"==typeof n&&n(e,Go),Module.isMobileDevice()?Go.addEventListener("cellclick",async t=>{Zo(e,t)}):Go.addEventListener("celldblclick",async t=>{Zo(e,t)}),Uo.addEventListener("click",e=>{!async function(){const e=Go.getSelected();if(0==e.length)return;if("ok"!=await $fgta5.MessageBox.confirm(`Apakah anda yakin akan menghappus ${e.length} data yang dipilih?`))return;let t=$fgta5.Modal.createMask();try{await async function(e,t){const n=`/${o.moduleName}/favourite-delete-rows`;try{const e=await Module.apiCall(n,{data:t});if(e.deleted)return!0;throw new Error(e.message)}catch(e){throw e}}(0,e)&&Go.removeSelected()}catch(e){console.error(e),$fgta5.MessageBox.error(e.message)}finally{t.close(),t=null}}()});const a=i.userFavouriteList_init;"function"==typeof a&&a(e),Ho.headerFormLocked=!0}function zo(e,t){const o=Ho.SelectedRow;o.previousElementSibling?t.disablePrevButton(e,!1):t.disablePrevButton(e,!0),o.nextElementSibling?t.disableNextButton(e,!1):t.disableNextButton(e,!0)}function qo(e,t){Ho.SelectedRow=t}async function Wo(e,t){const o=t.getAttribute("keyvalue"),n=t.getAttribute("key"),a=e.Modules.userFavouriteEdit;a.clearForm(e,"loading...");try{qo(0,t),Ho.SelectedRow.keyValue=o,Ho.SelectedRow.key=n,await a.openSelectedData(e,{key:n,keyvalue:o})}catch(e){console.error(e),await $fgta5.MessageBox.error(e.message),qo(0,null),To.show()}zo(e,a)}async function Zo(e,t){const o=t.detail.tr;e.Modules.userFavouriteEdit.Section.show({},t=>{Wo(e,o)})}async function Jo(e,t={}){const{criteria:n={},limit:a=0,offset:i=0,sort:r={}}=t;let s=$fgta5.Modal.createMask();try{const e=await async function(e,t,n,a,i){const r=`/${o.moduleName}/favourite-list`;try{const e=[];return await Module.apiCall(r,{columns:e,criteria:t,offset:n,limit:a,sort:i})}catch(e){throw e}}(0,n,i,a,r);0===i&&Go.clear(),Go.addRows(e.data),Go.setNext(e.nextoffset,e.limit)}catch(e){console.error(e),$fgta5.MessageBox.error(e.message)}finally{s.close(),s=null}}var Qo=Object.freeze({__proto__:null,Section:Ko,addNewRow:function(e,t){qo(e,Go.addRow(t))},getCurrentRow:function(e){return Ho.SelectedRow},getGrid:function(e){return Go},headerLocked:function(e){Ho.headerFormLocked=!0},headerUnlocked:function(e){Ho.headerFormLocked=!1},init:Vo,keyboardAction:function(e,t){if("up"==t)Go.previousRecord();else if("down"==t)Go.nextRecord();else if("enter"==t){e.Modules.userFavouriteEdit.Section.show({},t=>{Wo(e,Go.CurrentRow)})}},openList:async function(e,t){const o=t.moduleHeaderEdit;jo=o.getHeaderForm();const n=jo.getPrimaryInput().value,a=i.userFavouriteList_openList;"function"==typeof a&&a(e,jo);const r={user_id:n},s=Go.getSort();Go.clear(),Jo(e,{criteria:r,sort:s}),Ho.headerFormLocked?(Oo.setAttribute("disabled",""),Uo.disabled=!0):(Oo.removeAttribute("disabled"),Uo.disabled=!1)},removeCurrentRow:function(e){const t=Ho.SelectedRow;Go.removeRow(t)},selectNextRow:function(e){const t=Ho.SelectedRow;t.nextElementSibling&&(Go.CurrentRow=t.nextElementSibling,Wo(e,t.nextElementSibling))},selectPreviousRow:function(e){const t=Ho.SelectedRow;t.previousElementSibling&&(Go.CurrentRow=t.previousElementSibling,Wo(e,t.previousElementSibling))},setPagingButton:zo,updateCurrentRow:function(e,t){const o=Ho.SelectedRow;try{Go.updateRow(o,t)}catch(e){throw e}}});const Xo={},Yo=o.Crsl,en=o.Sections.userFavouriteEdit,tn=Yo.Items[en],on=o.Source,nn="New User",an="View User",rn="Edit User",sn="Edit",cn="Lock",dn=new $fgta5.ActionButton("userFavouriteEdit-btn_edit"),ln=new $fgta5.ActionButton("userFavouriteEdit-btn_save"),un=new $fgta5.ActionButton("userFavouriteEdit-btn_new","userFavourite-addrow"),fn=new $fgta5.ActionButton("userFavouriteEdit-btn_delete","userFavourite-delrow"),gn=new $fgta5.ActionButton("userFavouriteEdit-btn_reset"),pn=new $fgta5.ActionButton("userFavouriteEdit-btn_prev"),wn=new $fgta5.ActionButton("userFavouriteEdit-btn_next"),yn=document.getElementById("userFavourite-btn_recordstatus"),mn=document.getElementById("userFavourite-btn_logs"),bn=new $fgta5.Form("userFavouriteEdit-frm");bn.Inputs["userFavouriteEdit-obj_userfavouriteprogram_id"];const En=bn.Inputs["userFavouriteEdit-obj_program_id"];bn.Inputs["userFavouriteEdit-obj_user_id"];const Ln=document.getElementById("fRecord-section-createby"),vn=document.getElementById("fRecord-section-createdate"),hn=document.getElementById("fRecord-section-modifyby"),kn=document.getElementById("fRecord-section-modifydate"),Mn=tn;async function _n(t,n){tn.addEventListener($fgta5.Section.EVT_BACKBUTTONCLICK,async e=>{Bn()}),bn.addEventListener("locked",e=>{!async function(e){tn.Title=an,dn.setText(sn),dn.disabled=!1,ln.disabled=!0,un.disabled=!1,fn.disabled=!0,gn.disabled=!0,pn.disabled=!1,wn.disabled=!1;const t=i.userFavouriteEdit_formLocked;"function"==typeof t&&t(e,bn,Xo);Xo.editDisabled&&(dn.disabled=!0,un.disabled=!0)}(t)}),bn.addEventListener("unlocked",e=>{!async function(e){bn.isNew()?tn.Title=nn:tn.Title=rn;dn.setText(cn),dn.disabled=!1,ln.disabled=!1,un.disabled=!0,fn.disabled=!1,gn.disabled=!1,pn.disabled=!0,wn.disabled=!0;const t=i.userFavouriteEdit_formUnlocked;"function"==typeof t&&t(e,bn)}(t)}),bn.render(),dn.addEventListener("click",e=>{!async function(){if(bn.isLocked())bn.lock(!1);else{if(bn.isChanged()||bn.isNew())return void await $fgta5.MessageBox.warning(Module.EDIT_WARNING);bn.lock(!0)}}()}),ln.addEventListener("click",e=>{!async function(e){const t=i.userFavouriteEdit_autofill;"function"==typeof t&&await t(e,bn);if(!bn.validate()){const e=bn.getLastError();return void $fgta5.MessageBox.warning(e)}let n;const a=bn.isNew();if(a)n=bn.getData();else{if(!bn.isChanged())return;n=bn.getDataChanged()}let r=null;const s=bn.getFiles();if(null!=s){r=new FormData;for(let e in s){const t=s[e];r.append(e,t)}}const c=i.userFavouriteEdit_dataSaving;"function"==typeof c&&await c(e,n,bn);let d=$fgta5.Modal.createMask();try{let t;t=a?await async function(e,t,n){const a=`/${o.moduleName}/favourite-create`;try{return await Module.apiCall(a,{data:t,source:on},n)}catch(e){throw e}}(0,n,r):await async function(e,t,n){const a=`/${o.moduleName}/favourite-update`;try{return await Module.apiCall(a,{data:t,source:on},n)}catch(e){throw e}}(0,n,r);const s=bn.getPrimaryInput(),c=t[s.getBindingData()],d=await Sn(e,c);Xo.currentOpenedId=c,bn.AutoID?s.value=c:Cn(e,{disabled:!0}),bn.setData(d);const l=i["userFavouriteEdit_dataSaved"];"function"==typeof l&&await l(e,d,bn),bn.acceptChanges(),a?(dn.disabled=!1,e.Modules.userFavouriteList.addNewRow(e,d)):e.Modules.userFavouriteList.updateCurrentRow(e,d)}catch(e){console.error(e),await $fgta5.MessageBox.error(e.message)}finally{d.close(),d=null}}(t)}),un.addEventListener("click",e=>{!async function(e,t){const o=t.target.getAttribute("data-sectionsource"),n=e.Modules.userFavouriteList,a=n.Section.Id,r=o===a;if(r)tn.setSectionReturn(n.Section),await tn.show();else{let e=!1;if(bn.isChanged()){"cancel"==await $fgta5.MessageBox.confirm(Module.NEWDATA_CONFIRM)&&(e=!0)}if(e)return}bn.AutoID?Cn(e,{disabled:!0,placeholder:"[AutoID]"}):Cn(e,{disabled:!1,placeholder:"ID"});try{const t=e.Modules.userHeaderEdit,o=t.getHeaderForm().getPrimaryInput();let n={user_id:o.value};const a=i["userFavouriteEdit_newData"];"function"==typeof a&&await a(e,n,bn),await In(e,n),bn.lock(!1),dn.disabled=!0,fn.disabled=!0}catch(t){console.error(t),await $fgta5.MessageBox.error(t.message),r&&e.Modules.userFavouriteList.Section.show()}}(t,e)}),fn.addEventListener("click",e=>{!async function(e){if(bn.isNew())return;const t=bn.getPrimaryInput().value;if("ok"!=await $fgta5.MessageBox.confirm(Module.DELETE_CONFIRM+`id: ${t}`))return;let n=$fgta5.Modal.createMask();try{await async function(e,t){const n=`/${o.moduleName}/favourite-delete`;try{return await Module.apiCall(n,{id:t,source:on})}catch(e){throw e}}(0,t);e.Modules.userFavouriteList.removeCurrentRow(e),e.Modules.userFavouriteList.Section.show(),bn.lock()}catch(e){console.error(e),await $fgta5.MessageBox.error(e.message)}finally{n.close(),n=null}}(t)}),gn.addEventListener("click",e=>{!async function(){if(bn.isNew())In();else if(bn.isChanged()){if("ok"!=await $fgta5.MessageBox.confirm(Module.RESET_CONFIRM))return;bn.reset()}}()}),pn.addEventListener("click",e=>{!async function(e){e.Modules.userFavouriteList.selectPreviousRow(e)}(t)}),wn.addEventListener("click",e=>{!async function(e){e.Modules.userFavouriteList.selectNextRow(e)}(t)}),yn.addEventListener("click",n=>{!async function(t){const n={Context:o,sectionReturn:tn};e.openSection(t,"fRecord-section",n,async()=>{let e=$fgta5.Modal.createMask();try{const e=bn.getPrimaryInput().value,o=await Sn(t,e);Ln.innerHTML=o._createby,vn.innerHTML=o._createdate,hn.innerHTML=o._modifyby,kn.innerHTML=o._modifydate;const n=i["userFavouriteEdit_addRecordInfo"];"function"==typeof n&&await n(t,o)}catch(e){console.error(e),$fgta5.MessageBox.error(e.message)}finally{e.close(),e=null}})}(t)}),mn.addEventListener("click",n=>{!async function(t){const n={Context:o,sectionReturn:tn};e.openSection(t,"fLogs-section",n,async()=>{const t=bn.getPrimaryInput().value;let n=$fgta5.Modal.createMask();try{const n=`${o.appsUrls.core.url}/logs/list`,a={module:o.moduleName,table:"core.userfavouriteprogram",id:t},i=await Module.apiCall(n,{criteria:a}),r=document.getElementById("fLogs-section").querySelector("tbody");e.renderLog(r,i.data)}catch(e){console.error(e),$fgta5.MessageBox.error(e.message)}finally{n.close(),n=null}})}(t)}),Xo.headerFormLocked=!0,Xo.editDisabled=!1,En.addEventListener("selecting",async e=>{if("function"==typeof fn_obj_program_id_selecting)fn_obj_program_id_selecting(t,En,bn,e);else{const a=e.detail.sender,r=e.detail.dialog,s=null!=e.detail.searchtext?e.detail.searchtext:"",c=`${o.appsUrls.core.url}/program/header-list`,d={searchtext:s},l=i["obj_program_id_selecting_criteria"];"function"==typeof fn_selecting_criteria&&l(t,En,d),a.wait();try{const t=await Module.apiCall(c,{criteria:d,offset:e.detail.offset,limit:e.detail.limit});for(var n of t.data)e.detail.addRow(n.program_id,n.program_name,n);r.setNext(t.nextoffset,t.limit)}catch(e){$fgta5.MessageBox.error(e.message)}finally{a.wait(!1)}}})}async function In(e,t){try{bn.newData(t),bn.acceptChanges(),bn.setAsNewData()}catch(e){throw e}}async function Sn(e,t){const n=`/${o.moduleName}/favourite-open`;try{return await Module.apiCall(n,{id:t})}catch(e){throw e}}async function Bn(e,t){let n=!1;bn.isChanged()?"ok"==await $fgta5.MessageBox.confirm(Module.BACK_CONFIRM)&&(bn.reset(),n=!0):n=!0;if(n){bn.lock();const e=o.Sections.userFavouriteList;Yo.Items[e].show({direction:1})}}async function Cn(e,t){const o=bn.getPrimaryInput();o.disabled=!0===t.disabled,void 0!==t.placeholder&&(o.placeholder=t.placeholder),void 0!==t.value&&(o.value=t.value)}var Rn=Object.freeze({__proto__:null,Section:Mn,clearForm:function(e,t){bn.clear(t)},disableNextButton:function(e,t=!0){wn.disabled=t},disablePrevButton:function(e,t=!0){pn.disabled=t},getForm:function(e){return bn},headerLocked:function(e){Xo.headerFormLocked=!0,Xo.editDisabled=!0,un.disabled=!0},headerUnlocked:function(e){Xo.headerFormLocked=!1,Xo.editDisabled=!1,un.disabled=!1},init:_n,keyboardAction:function(e,t){"save"==t?(bn.acceptInput(),ln.click()):"new"==t?(bn.acceptInput(),un.click()):"escape"==t?(bn.acceptInput(),bn.isLocked()||bn.isNew()?Bn():dn.click()):"togleEdit"==t?(bn.acceptInput(),dn.click()):"right"==t?wn.click():"left"==t&&pn.click()},openSelectedData:async function(e,t){let o=$fgta5.Modal.createMask();try{En.clear();const o=t.keyvalue,n=await Sn(e,o);if(Xo.currentOpenedId=o,!Xo.headerFormLocked){const t=i["userFavouriteEdit_isEditDisabled"];if("function"==typeof t){const o=t(e,n);Xo.editDisabled=o}}Cn(e,{disabled:!0}),bn.setData(n),bn.acceptChanges(),bn.lock();const a=i["userFavouriteEdit_formOpened"];"function"==typeof a&&a(e,bn,Xo)}catch(e){throw Xo.currentOpenedId=null,e}finally{o.close(),o=null}}});const $n=o.app,xn=o.Crsl;class Nn extends Module{constructor(){super()}async main(e={}){$n.setTitle("User"),$n.showFooter(!0),e.autoLoadGridData=!0;const t=this;t.Modules={userHeaderList:h,userHeaderEdit:ee,userLoginList:ye,userLoginEdit:qe,userPropList:dt,userPropEdit:Gt,userGroupList:oo,userGroupEdit:Ao,userFavouriteList:Qo,userFavouriteEdit:Rn};try{try{const e=await Module.apiCall(`/${o.moduleName}/init`,{});o.notifierId=e.notifierId,o.notifierSocket=e.notifierSocket,o.userId=e.userId,o.userFullname=e.userFullname,o.sid=e.sid,o.appsUrls=e.appsUrls}catch(e){throw e}await Promise.all([w(t,e),Z(t),le(t),Ue(t),nt(t),At(t),Jt(t),Ro(t),Vo(t),_n(t),a(t)]),await async function(e){try{const t=document.getElementsByClassName("footer-buttons-container");Module.renderFooterButtons(t),xn.setIconUrl("public/modules/user/user.png"),xn.addEventListener($fgta5.SectionCarousell.EVT_SECTIONSHOWING,e=>{var o=e.detail.commingSection.Id;for(let e of t){e.getAttribute("data-section")==o?setTimeout(()=>{e.classList.remove("hidden"),e.style.animation="dropped 0.3s forwards",setTimeout(()=>{e.style.animation="unset"},300)},500):e.classList.add("hidden")}}),xn.Items["fRecord-section"].addEventListener($fgta5.Section.EVT_BACKBUTTONCLICK,async e=>{e.detail.fn_ShowNextSection()}),xn.Items["fLogs-section"].addEventListener($fgta5.Section.EVT_BACKBUTTONCLICK,async e=>{e.detail.fn_ShowNextSection()}),xn.Items["fAbout-section"].addEventListener($fgta5.Section.EVT_BACKBUTTONCLICK,async e=>{e.detail.fn_ShowNextSection()});document.getElementById("panel-detil-selector").querySelectorAll(".panel-detil-row a").forEach(t=>{t.addEventListener("mouseenter",()=>{t.closest(".panel-detil-row").classList.add("panel-detil-row-highligted")}),t.addEventListener("mouseleave",()=>{t.closest(".panel-detil-row").classList.remove("panel-detil-row-highligted")});const n=t.getAttribute("data-target-section"),a=t.getAttribute("data-current-section");t.addEventListener("click",t=>{!function(e,t,n){const a=o.Sections[n],i=xn.Items[a],r=o.Sections[t],s=xn.Items[r];s.setSectionReturn(i),s.show({},()=>{const o=e.Modules[t],a=e.Modules[n];o.openList(e,{moduleHeaderEdit:a})})}(e,n,a)})});const n=i["extendPage"];"function"==typeof n&&n(e)}catch(e){throw e}}(t),function(e){const t=/^[a-zA-Z0-9 ]$/;document.addEventListener("keydown",n=>{if(n.ctrlKey||n.metaKey||n.altKey);else if(t.test(n.key)||"Backspace"===n.key||"Delete"===n.key){const t=xn.CurrentSection.Id,a=o.SectionMap[t],i=e.Modules[a];Fn(e,i,"typing",n)}},!0),document.addEventListener("keydown",t=>{const n=xn.CurrentSection.Id,a=o.SectionMap[n],i=e.Modules[a],r=document.querySelector("dialog[open]");if(r)return void("escape"==t.key.toLowerCase()?(r.close(),t.preventDefault()):(t.ctrlKey||t.metaKey)&&"s"===t.key.toLowerCase()&&t.preventDefault());const s=t.key.toLowerCase();(t.ctrlKey||t.metaKey)&&"s"===s?(t.preventDefault(),Fn(e,i,"save",t)):(t.ctrlKey||t.metaKey)&&"n"===s||t.ctrlKey&&"f2"===s?(t.preventDefault(),Fn(e,i,"new",t)):"escape"===s?(t.preventDefault(),Fn(e,i,"escape",t)):"f2"===s?Fn(e,i,"togleEdit",t):"arrowup"===s?Fn(e,i,"up",t):"arrowdown"===s?Fn(e,i,"down",t):"arrowright"===s?Fn(e,i,"right",t):"arrowleft"===s?Fn(e,i,"left",t):"enter"===s&&Fn(e,i,"enter",t)})}(t);const n=["userHeaderEdit","userLoginEdit","userPropEdit","userGroupEdit","userFavouriteEdit"];window.onbeforeunload=e=>{let o=!1;for(var a of n){t.Modules[a].getForm(t).isChanged()&&(o=o||!0)}if(o)return e.preventDefault(),"Changes you made may not be saved."}}catch(e){throw e}}}function Fn(e,t,o,n){null!=t?t.keyboardAction(e,o,n):"escape"==o&&xn.CurrentSection.back()}export{Nn as default};
